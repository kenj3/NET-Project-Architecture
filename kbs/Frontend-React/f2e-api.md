# 前后端对接接口API规范

#### [返回目录](README.md)

### 1 接口数据通用原则

* 避免多数据源

> 尽量避免通过多接口调用获取数据来完成一个渲染逻辑的需求。

* 扁平数据结构

> 接口返回值应该尽可能保持结构扁平，谢绝嵌套层级过深的接口数据。

* 不关注业务逻辑

> 前端关注交互、渲染逻辑，尽量避免业务逻辑处理的出现。  
> JavaScript在浮点数据计算精度上有比较明显的精度误差，所以不要把业务计算逻辑放到前端（尤其是浮点数计算）。推荐计算后再接口里直接返回。

* 默认值统一

> 页面字段默认值需要约定契约的时候就明确好。  
> 无值的默认值不可以是`0`。通用无值的默认值为`null`。

### 2 请求基本格式

`GET` 请求
> key，value参数请求

`POST` 请求
> JSON格式

### 3 响应基本格式

```javascript
// 通用对象返回
{
    code: 200,                       // 响应状态码
    msg: '响应消息',                  // 响应消息体
    data: {
        // 响应数据体
        xxx: '',
        yyy: {},
        zzz: []
    }
}

// 通用数组返回
{
    code: 200,                       // 响应状态码
    msg: '响应消息',                  // 响应消息体
    data: [
        // 响应数据体
        {
            xxx: '',
            yyy: {},
            zzz: []
        }
    ]
}

// 通用列表返回（带分页查询）
{
    code: 200,                        // 响应状态码
    msg: '响应消息',                   // 响应消息体
    data: {
        content: [                    // 列表数据体
            {
                xxx: '',
                yyy: {},
                zzz: []
            }
        ],
        sort: {                       // 列表排序方式
            property: 'id',           // 排序属性的key
            direction: 'ASC'          // 排序方式    ASC[升序] | DESC[降序]
        },
        page: 1,                      // 当前页码
        size: 20,                     // 每页展示数
        total: 200,                   // 列表总数
        totalPage: 10                 // 列表总页数
    }
}


// 请求失败（网络不通，环境不对导致）
{
    code: 500,                        // 错误状态码
    msg: '响应消息',                   // 错误消息体
    data: {}
}

// 请求失败（业务错误）
{
    code: XXXXX,                      // 建议4-5位数错误码，用来和系统级别，通用错误码区分开来
    msg: '响应消息',                   // 错误消息体
    data: {}
}

```

#### code请求处理状态码通用约定

* 200: 请求处理成功
* 500: 请求处理失败
* 401: 用户未登录，跳转登录页
* 403: 用户无权限，展示无权限

### 4 特殊内容规范

* Boolean类型

> 关于Boolean类型，JSON数据传输中一律使用`1/0`来标示，1为是/True，0为否/False；

* 日期类型

> 关于日期类型，JSON数据传输中一律使用字符串，具体日期格式因业务而定；推荐使用`时间戳`。

* 下拉框数据

> antd组件下拉框的value格式一律为`字符串`，建议使用字符串来作为下拉框的值。特指全站通用数据的ID。


### [返回目录](README.md)
